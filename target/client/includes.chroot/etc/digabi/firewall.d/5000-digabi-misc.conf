# TODO: Split to separate files

-A digabi-input -p tcp -m tcp --dport 80 -i lo -s 127.0.0.0/8 -d 127.0.0.0/8 -j ACCEPT -m comment --comment "Allow access to local webserver."

-A digabi-output -p udp -m udp --dport 53 -j ACCEPT
-A digabi-output -o lo -p tcp -m tcp --dport 4010:4012 -s 127.0.0.0/8 -d 127.0.0.0/8 -j ACCEPT -m comment --comment "Allow Maxima."
#-A digabi-output -o lo -p tcp -m tcp --dport 8123 -s 127.0.0.0/8 -d 127.0.0.0/8 -m owner --uid-owner dansguardian -j ACCEPT -m comment --comment "Allow proxy access for dansguardian (dansguardian -> proxy)."
#-A digabi-output -o lo -p tcp -m tcp --dport 8080 -s 127.0.0.0/8 -d 127.0.0.0/8 -j ACCEPT -m comment --comment "Allow dansguardian access for all users (user -> dansguardian -> proxy)."
-A digabi-output -p tcp -m tcp --dport 8010 -s 127.0.0.0/8 -d 127.0.0.0/8 -j ACCEPT -m comment --comment "Allow access from browser to Node.js."
-A digabi-output -p tcp -m tcp --dport 7910 -s 127.0.0.0/8 -d 127.0.0.0/8 -j ACCEPT -m comment --comment "Allow access from browser to test Node.js."
-A digabi-output -p tcp -m tcp --dport 80 -s 10.10.0.0/16 -d 10.10.0.1/32 -j ACCEPT -m comment --comment "Allow Node.js to Exam server access."
-A digabi-output -p tcp -m tcp --dport 443 -s 10.10.0.0/16 -d 10.10.0.1/32 -j ACCEPT -m comment --comment "Allow Node.js to Exam server SSL access."
#-A digabi-output -p tcp -m tcp --dport 80 -m owner --uid-owner proxy -j ACCEPT -m comment --comment "Allow HTTP for user proxy."
#-A digabi-output -p tcp -m tcp --dport 443 -m owner --uid-owner proxy -j ACCEPT -m comment --comment "Allow HTTPS for user proxy."
-A digabi-output -p tcp -m tcp --dport 80 -j ACCEPT -m comment --comment "Allow HTTP."
-A digabi-output -p tcp -m tcp --dport 443 -j ACCEPT -m comment --comment "Allow HTTPS."
-A digabi-output -p tcp -m tcp --dport 3128 -j ACCEPT -m comment --comment "Temporarily allow access to 3128/tcp (Squid Proxy default port)."

#!/bin/sh

set -e

# only auto-mount vfat and hfsplus
# don't use sync but flush (except for HFS+)
# use digabi user

sed -i \
    -e 's/^FILESYSTEMS=.*/FILESYSTEMS="vfat hfsplus"/' \
    -e '/^MOUNTOPTIONS/s/sync,//' \
    -e '/^MOUNTOPTIONS/s/OPTIONS="/OPTIONS="uid=digabi,/' \
    -e 's/^FS_MOUNTOPTIONS=.*/FS_MOUNTOPTIONS="-fstype=vfat,sync -fstype=hfsplus,sync"/' \
    /etc/usbmount/usbmount.conf
#!/bin/sh

set -e

WHITELISTED="root daemon nobody"
ACCOUNTS="$(cat /etc/passwd |cut -d: -f1)"

echo "I: Remove unnecessary shells..."
for a in ${ACCOUNTS}
do
    [[ ${WHITELISTED} =~ $a ]] && echo "I: Shell for user ${a} is whitelisted, leaving untouched" ||Â echo "I: Setting shell for user ${a} to /bin/false" && chsh ${a} -s /bin/false
done
